services:
    enhavo_translation.metatdata.collection:
        class: Enhavo\Bundle\TranslationBundle\Metadata\MetadataCollection
        arguments:
            - '@kernel'

    enhavo_translation.translator:
        class: Enhavo\Bundle\TranslationBundle\Translator\Translator
        arguments:
            - '@enhavo_translation.metatdata.collection'
            - '@request_stack'
            - '%enhavo_translation.locales%'
            - '%enhavo_translation.default_locale%'
        calls:
            - [ setContainer, ['@service_container']]

    enhavo_translation.doctrine_subscriber:
        class: Enhavo\Bundle\TranslationBundle\EventListener\DoctrineSubscriber
        arguments:
            - '@enhavo_translation.translator'
        tags:
            - { name: doctrine.event_subscriber, connection: default }

    enhavo_translation.extension.text:
        class: Enhavo\Bundle\TranslationBundle\Form\Extension\TextExtension
        arguments:
            - '@enhavo_translation.translator'
            - '%enhavo_translation.default_locale%'
        tags:
            - { name: form.type_extension, extended_type: Symfony\Component\Form\Extension\Core\Type\TextType }

    enhavo_translation.save_listener:
        class: Enhavo\Bundle\TranslationBundle\EventListener\SaveListener
        arguments:
            - '@enhavo_translation.translator'
        tags:
            - { name: kernel.event_listener, event: enhavo_app.post_create, method: postSave }
            - { name: kernel.event_listener, event: enhavo_app.post_update, method: postSave }

    enhavo_translation.menu_builder.translation:
        class: Enhavo\Bundle\TranslationBundle\Menu\TranslationStringsMenuBuilder
        calls:
          - [ 'setContainer', ['@service_container']]
        tags:
            - { name: enhavo.menu, alias: translation }